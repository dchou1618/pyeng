name: deploying to docker registry
on:
	push:
		branches: master

jobs:
	push_to_registry:
		name: push to docker registry
		runs-on: ubuntu-latest
		steps:
			- name: checkout repo
			  uses: actions/checkout@v1
			- name: login to docker
			  uses: docker/login-action@f4ef78c080cd8ba55a85445d5b36e214a81df20a
			  with:
			  	username: ${{ secrets.DOCKER_USERNAME }}
				password: ${{ secrets.DOCKER_PASSWORD }}
			- name: Extract metadata (tags, labels) for Docker
			  id: meta
			  uses: docker/metadata-action@9ec57ed1fcdbf14dcef7dfbe97b2010124a938b7
			  with:
			  	images: dchou1618/pyeng
			- name: Build and push Docker image
			  uses: docker/build-push-action@3b5e8027fcad23fda98b2e3ac259d8d67585f671
			  with:
			  	context: .
          		file: ./Dockerfile
          		push: true
          		tags: dchou1618/pyeng:${{ steps.meta.outputs.tags }}
          		labels: ${{ steps.meta.outputs.labels }}
